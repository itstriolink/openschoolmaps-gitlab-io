= Rendering Points: Displaying Points by Displacement as Point Cluster and as Heatmap
OpenSchoolMaps.ch -- Free learning materials on free geodata and maps
:xrefstyle: short
:imagesdir: ../../../bilder/rendering_points_with_qgis/
:experimental:
include::../../../snippets/lang/de.adoc[]
include::../../../snippets/suppress_title_page.adoc[]

== Objectives

This worksheet shows how you can use specific point rendering techniques in order to overcome map challenges involving points. We will be using different point renderers offered by QGIS in order to demonstrate how such challenges can be obstacled. (TBC)

This exercise will be using data consisting of the castles of Switzerland (archeological sites, fortifications, towers inc.) in order to demonstrate some point rendering techniques. +
It will be using only a few of the QGIS point rendering techniques: 

* Using the Point Displacement Renderer and 
* Generating Heatmaps

After completing this worksheet, you will be able to:

* Understand what challenges points can pose and how to overcome those challenges
* Use key point rendering techniques efficiently using QGIS
* (TBC) ...

== Introduction
Anything in the real world can be displayed as a point, however, points can pose a lot of challenges. These challenges must be tackled somehow, using specific techniques and renderers. In this worksheet, we will be describing and explaining some of the QGIS renderers that solve specific problems of points.

This worksheet includes:

* What are points and what problems can they pose?
* Point Displacement Renderer
* Generating Heatmaps from points

.A points layer in QGIS
image::qgis_points.png[QGIS and a points layer, 550]

=== Data
In this worksheet, we took a special example of all the historical sites in Switzerland such as: castles, towers, archeological sites, forts etc. This is a neat example to demonstrate what points are and what rendering techniques can be used to overcome specific challenges that they can pose. 

The geodata used for this worksheet is in the _.geojson_ format and it's taken from the OSM overpass web tool (_overpass-turbo.osm.ch_), which is a very straightforward process for retrieving these types of data.

This data is taken directly from OpenStreetMap and all of the tags of the found objects is also copied to the file, including the coordinates for that OpenStreetMap object. QGIS is able to read _.geojson_ files and process them into the map. 

A _.geojson_ file looks something like this:

.A .geojson file example
image::geojson_example.png[A .geojson file example, 550]

More information on the _.geojson_ file extension can be found here: https://geojson.org/

== Prerequisites and Rendering Techniques
In this chapter, we will be discussing some of the point rendering techniques offered by QGIS that can tackle problems with points. (TBC)

=== Prerequisites
In order to understand and complete this worksheet, you need the following prerequisites:

* QGIS environment (tested with QGIS 3.10.1-A Coru√±a)
* Data:
** `castles.geojson` file


After that has been achieved, we will load the necessary data into QGIS and start using and explaining some of the point rendering techniques offered by QGIS.

=== Point Displacement Renderer
One of the key point rendering techniques is called as per QGIS: _Point Displacement Renderer_. This rendering technique allows you to cartographically shift overlapping points.

What this rendering technique actually does is just move all of the overlapping points in the map view so that they can all become visible.

Suppose we have a lot of points within a map layer. If we zoom out the map layer, it would mean that a lot of points are located on top of each other (overlapping). In order to make all of the points visible, some technique must be used in order to tackle this problem. Here's when point displacement technique comes in. It takes all of the points and analyzes where they're located in the map view and then places shifts them and places symbols around them to denote where the point actually belongs to.

Here's how some points look after applying the point displacement rendering technique: 

.Castles of Switzerland after applying the point displacement rendering technique
image::point_displacement_map.PNG[Point displacement technique, 550]

.An example of how overlapping points are rendered with a center symbol after using points displacement
image::point_displacement_example.png[Point displacement example, 150] 


The point displacement renderer also offers us a few options. +
With these options, we can set the:

* Center symbol shape/color
* Renderer mode for the points
* Distance to shift the overlapping points
* Placement method
* Displacement line shape/color
* Labels etc.

.Point displacement options offered by QGIS
image::point_displacement_options.png[Point displacement options, 300] 

=== Generating Heatmaps
Another important rendering technique is rendering points as a heatmap. This technique is one of the best visualization tools for dense point data. It is useful in determining the density of the input objects. A heatmap rendering technique is most useful when we want to identify clusters of points where there's a high density. They can be useful for a lot of scenarios such as: finding hotspots of crime, traffic incidents, housing density, other types of crime data etc.

We will be using the same map features as before to demonstrate the heatmap rendering technique (castles and towers of Switzerland).

This is a heatmap generated in QGIS using the castles and towers of Switzerland map features:

.Heatmap generated from the map features
image::heatmap_generation_map.png[Heatmap generation technique, 550]

After generating the heatmap, a few options are displayed in QGIS.
These options allow us to set the: 

* Color of the heatmap and of the background
* Quality of the heatmap rendering
* Maximum value
* How to weigh points etc.

.Heatmap generation options offered by QGIS
image::heatmap_generation_options.png[Heatmap generation options, 550]


== Exercises (TBC)
=== Preparation: Requirements before starting the exercises (TBC)
1. Where and how to get the data (castles.geojson)...?
2. How to load the data in QGIS (castles.geojson)...?
3. How to save it as a project and move on to exercises(castles_towers_CH.qgz)...?

=== Exercise 1: Using the point displacement renderer (TBC)

=== Exercise 2: Generating heatmaps (TBC)

== Conclusion (TBC)
With this worksheet, you have learned how points look like in the map and how we can use different point rendering techniques to tackle specific problems that points can pose.

Every one of the point rendering techniques solves specific problems, there is no point rendering techniques that solves all of the point problems. This means that you should choose carefully which technique you decide to use to tackle a problem.