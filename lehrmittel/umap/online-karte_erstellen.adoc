= Mit uMap eine thematische Online-Karte erstellen
OpenSchoolMaps.ch -- Freie Lernmaterialien zu freien Geodaten und Karten
:imagesdir: ../../bilder/
include::../../snippets/lang/de.adoc[]
include::../../snippets/suppress_title_page.adoc[]

:sectnums!:
== Übersicht

.Ziel
Das Ziel dieser Anleitung ist es,
dass Lehrpersonen wie Sie fähig sind,
mit uMap eine thematische Online-Karte zu erstellen.

.Zeitplanung
tbd.

.Kapitelübersicht
image::umap/online-karte_erstellen/uml_diagram.svg["SVG"]

:sectnums:
== Geodaten in uMap einbinden

Um zu beginnen,
suchen Sie in OpenStreetMap nach den Geodaten,
die Sie in uMap einbinden wollen.
Sie können Werkzeuge wie
taginfo,
das OpenStreetMap-Wiki
oder tagfinder dazu verwenden.
Wenn sich die Geodaten,
die Sie verwenden möchten,
nicht in OpenStreetMap befinden,
können Sie mit dem nächsten Kapitel
(_Daten nicht in OpenStreetMap vorhanden_)
fortfahren.

Andernfalls fahren Sie zum Kapitel
_Daten in OpenStreetMap vorhanden_
fort.

[NOTE]
====
Taginfo: https://taginfo.openstreetmap.ch/ +
OpenStreetMap-Wiki: https://wiki.openstreetmap.org/ +
Tagfinder: http://tagfinder.herokuapp.com/
====

== Daten nicht in OpenStreetMap vorhanden

=== Daten manuell in uMap erfassen

Wenn sich die Daten,
die Sie in uMap einbinden wollen,
nicht in OpenStreetMap befinden,
können Sie die Daten von Hand in uMap erfassen.
Hierbei spielt es eine Rolle,
um wie viele Geodaten es sich handelt.
Je nach Menge der Geodaten,
kann sich diese Prozedur sehr in die Länge ziehen.
Schauen Sie sich dazu das Arbeitsblatt
"Mit uMap einen Lageplan erstellen"
auf
https://www.openschoolmaps.ch
an,
wenn Sie sich für diese Methode entscheiden.

=== Geodaten erfassen

Wenn Sie stattdessen die Geodaten,
in Form von Text,
erzeugen möchten,
können Sie dies mit zum Beispiel geojson.io
oder QGIS Desktop
(Sehen Sie dazu: https://www.qgistutorials.com/de/)
machen.

geojson.io ist eine Webseite,
die Ihnen ermöglicht auf einer Karte
Punkte,
Linien,
Rechtecke
und Polygons zu zeichnen
und diese danach in Form eines GeoJSONs abzuspeichern.

Nachdem Sie Ihre Geodaten erfasst haben,
kopieren Sie sich die Daten in die Zwischenablage
und fügen Sie es in uMap unter _Import Data_ ein.

Wenn Sie eine Datei mit Geodaten importieren möchten,
sehen Sie sich das Kapitel
_Daten als externe Datenquelle/Datei vorhanden_
an.

[NOTE]
====
Stellen Sie sicher,
dass Sie Ihre Daten in einer der folgenden Dateiformaten erfasst haben:
*geojson, csv, gpx, kml, osm, georss, umap*

Wir empfehlen Ihnen die Daten im GeoJSON-Format zu importieren.
Im GeoJSON-Format werden alle Attribute importiert.
Mit anderen Formaten werden möglicherweise nicht alle Attribute mit importiert.

Wenn Sie sich entscheiden CSV zu brauchen,
vergewissern Sie sich,
dass Sie eine Kolumne _lat_
und
_lon_ haben.
Alle andere Kolumnen werden als Attribute importiert.
====

.Beispiel wie man ein GeoJSON in uMap importiert
image::umap/online-karte_erstellen/umap_import_data.PNG["Import Data Menu in uMap", 275, 306]

Unter
_Choose the format of the data to import_
müssen Sie das Dateiformat Ihrer Datei angeben.

Mit der Schaltfläche
_Import_
werden Ihre Dateien in uMap importiert.

=== Daten in OpenStreetMap erfassen

Eine weitere Möglichkeit ist,
wenn Sie die Daten nicht sofort brauchen,
dass Sie die Daten selber in OpenStreetMap gleich erfassen.
(Sehen Sie sich dazu das Arbeitsblatt "OpenStreetMap bearbeiten"
auf
https://www.openschoolmaps.ch
an.)
Nachdem OpenStreetMap erfolgreich die Daten auf der Webseite darstellt,
können Sie auf Kapitel *Daten in OpenStreetMap vorhanden* fortfahren.

== Daten als externe Datenquelle/Datei vorhanden

Wenn Sie die Geodaten als Datei vorhanden haben,
können Sie die auch in uMap importieren.
Navigieren Sie dazu wieder in uMap unter _Import Data_
und klicken Sie auf die _Browse..._ Schaltfläche.
Wählen Sie Ihre Datei aus und bestätigen Sie mit "Öffnen".

NOTE: Wiederum empfehlen wir Ihnen,
wenn möglich,
eine Datei im GeoJSON-Format zu importieren

Unter
_Choose the format of the data to import_
müssen Sie das Dateiformat Ihrer Datei angeben.

Mit der Schaltfläche
_Import_
werden Ihre Dateien in uMap importiert.

CAUTION: Vergewissern Sie sich,
falls Ihre Daten vom Internet stammen,
dass Sie keine Lizenzen verstossen.

== Daten in OpenStreetMap vorhanden

=== Einen Snapshot der OSM-Daten

Um nur den aktuellen Stand der Daten in uMap zu importieren,
verwenden Sie https://overpass-turbo.osm.ch/.
Mit dem Werkzeug Wizard,
können Sie nach bestimmten Tags in OpenStreetMap suchen.
Wenn Sie mit den Ergebnissen zufrieden sind,
können Sie unter _Export_ die Ergebnisse als GeoJSON exportieren.

Wie Sie eine Datei in uMap importieren,
sehen Sie im Kapitel
_Daten als externe Datenquelle/Datei vorhanden_.

=== Daten immer auf dem aktuellsten Stand halten

Wenn Sie die Daten auf Ihrer uMap immer aktuell halten möchten,
ist das ganze ein wenig komplizierter.
Öffnen Sie hierzu wieder https://overpass-turbo.osm.ch/
und suchen Sie mit dem Wizard nach z.b *amenity=bar*.
Nun drücken Sie auf
_convert to (*compact*)_
unter _Export_ -> _Query_.

Ihnen wird ein neuer Tab mit einem Hyperlink geöffnet.
Öffnen Sie den Hyperlink und kopieren Sie sich die URL.
Auf https://meyerweb.com/eric/tools/dencoder/ können Sie die URL einfügen und decodieren.

Kopieren Sie sich den decodierten Code in einen Texteditor Ihrer Wahl.

Nun müssen Sie in der decodierten URL alle 3 Koordinatenangaben durch folgendes ersetzten: +
`({south},{west},{north},{east})`

Die URL sollte nun etwa so aussehen:

....
https://overpass.osm.ch/api/interpreter?data=[out:json][timeout:25];(node["amenity"="bar"]({south},{west},{north},{east});way["amenity"="bar"]({south},{west},{north},{east});relation["amenity"="bar"]({south},{west},{north},{east}););out;>;out skel qt;
....

Kopieren Sie sich diese URL
und
gehen Sie auf Ihre uMap Karte.
Editieren Sie den aktuellen Layer
(oder erzeugen Sie einen neuen Layer)
in dem Sie auf das Stift-Symbol klicken
unter _Manage layers_.

.Layer editieren in uMap
image::umap/online-karte_erstellen/umap_manage_layers.PNG["Manage Layers Menu", 342, 288]

Im Editiermenu öffnen Sie das Menu
_Remote Data_
und fügen Sie die kopierte URL in das Textfeld URL.

Als _Format_ wählen Sie OSM aus
und
aktivieren Sie dazu noch die Schaltfläche _Dynamic_.

.Remote Data in uMap eintragen
image::umap/online-karte_erstellen/umap_remote_data.PNG["Remote Data Menu", 274, 532]

Unter _From zoom_ können Sie noch einen Mindest-Zoom angeben,
für den Fall,
dass Sie viele Daten haben die uMap in angezeigt werden müssen.

== Abschluss

Mit einem Klick auf die blaue
_Save_-Schaltfläche
oben rechts
und
der
_Disable editing_-Schaltfläche
ist Ihre Karte nun fertig!

Sie können nun Ihre Karte teilen,
in Webseiten einbinden
und
sie bleibt immer auf dem neusten Stand von OpenStreetMap!
