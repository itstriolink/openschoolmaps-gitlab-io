= Introduction to QGIS 3: Data collection and Management (Chapter 3)
OpenSchoolMaps.ch -- Freie Lernmaterialien zu freien Geodaten und Karten
:xrefstyle: short
:imagesdir: ../../../bilder/
include::../../../snippets/lang/de.adoc[]
include::../../../snippets/suppress_title_page.adoc[]

*A worksheet*
ifdef::show_solutions[- *LÖSUNGEN*]

You have probably already 
entered datain a table (e.g. an Excel
spreadsheet).What kind of data did you
enter? Where did the values 
you entered come from? Where could
values come from in general 
terms that are stored in a table?
As an introduction to this 
chapter, think about these 
questions for two to three 
minutes. Make a note of them
on your worksheet. Go on in this
chapter only then.

== Learning objectives of the theory

This chapter has the following learning objectives:

* explain the structure of a
table in your own words
* list at least 4 types of
data acquisition without tools
* show in your own words
why it is worth investing 
money and time in data 
acquisition and management.

== Theory

In the chapter Geodata and 
spatial reference we have 
seen that there are generally
two ways to store geodata: 
In the form of vector data 
and raster data. Since you will
probably save the data you 
collect as vector data in future
GIS projects, this chapter 
will also deal with the 
collection of vector data.

=== Table

First, however, we will deal with 
the general recording of values in
*tables*. A table consists of *rows*
and *columns*. The row is _horizontal_
and the different datasets are stored
in it. The column is _vertical_ and 
a certain property of a data set is
stored in it.

Tables are often used to store values
from measurements. For example, the 
number of students in a class can be
stored in a table. The number of 
students of a class can be counted. 
In addition, the class teacher could
also be entered in the table. 
The corresponding table would then 
look as follows.

[%header,cols=3*]
|===
|Class
|Number of students
|Teacher

|1c
|22
|Gaby Meyer

|2b
|24
|Franz Peter

|...
|...
|...
|===

The names of the columns 
(e.g. class, number of students...) 
are called *attributes*.

For geodata, the geometry must also
be saved in addition to the 
attributes. In the previous exercises
you already got to know the shapefile
as a storage type for geodata. With
the Shapefile, the geometry and the
attribute data are saved in 
different files.

Open the directory in which the data
for the exercise is stored and take a
closer look at the data. In addition
to the main file with the extension 
_.shp_ there are other files with the
same name but a different extension. 
For example, the file with the 
extension _.dbf_ contains the factual
data and the file with the extension 
_.prj_ contains the coordinate system.
All these files together form 
the shape file.

The geodata can also be stored in 
special databases, so-called 
*geodatabases*. These databases 
function similarly to normal databases,
but additionally offer the possibility
to manage geometry as well as factual 
information. Normal databases cannot 
do this. Examples for geo databases 
are e.g. _Oracle Spatial_ and _PostGIS_.

=== Data acquisition

Now you have learned in which form
geodata can be saved. But how do 
you get from the objects in the 
real world to the information you 
want to store?

image:einfuehrung_in_qgis/ausrufezeichen.png[exclamation mark, 15, 15]
_Task 1_ +
_Think for two to three minutes
about what sources the data might
come from and what collection 
methods you know. Continue 
in the text only then._

ifdef::show_solutions[]
====
.Solution
Compare your solution with the data 
collection possibilities from theory.
====
endif::show_solutions[]

There are many methods to capture 
geodata. We would like to 
briefly discuss some of them. 

. In part 1 of this guidance program,
the example with the mobile phone 
with integrated GPS was used. Besides
measuring with tachymeters, GPS is 
a popular method in surveying to 
record the geometry of objects in the
field. Often the result of 
measurements has to be read into the 
GIS project as a text file containing
coordinate and attribute values.
. Aerial images are often used
as background images.
. Often plans are still available in
analogue form, i.e. as paper maps. 
In order to convert these plans into
digital form, they must be scanned. 
After scanning, the data is digital, 
but has no spatial reference. In order
to obtain a spatial reference, they must
also be georeferenced (see chapter 
Geodata and spatial reference).
. Aerial photographs and digitized and
georeferenced plans often provide a good
basis for converting objects into vector
format. This process is also 
called vectorizing.
. Some data have already been collected
in another GIS project. Some of these 
data can be transferred without adjustments.
Often the data format or the coordinate 
system have to be adapted or additional 
attributes have to be entered.
. Statistical offices publish a large 
number of statistical surveys. These
statistical data can be imported and
linked to the corresponding geometric
objects, such as cantonal boundaries,
in order to obtain a spatial reference.

Data acquisition and management usually
takes a lot of time. But the effort is
worth it, because the data can be 
regarded as the core of the GIS. If the
quality of the data is poor or the data
is incomplete or outdated, the results
of the evaluations or the maps created
from the data are correspondingly poor.

Compared to the other GIS components 
software and hardware, the data have
a very long service life. While 
better and faster computers are coming
onto the market and the software 
products are usually outdated after
a few years, the data can be 
used for decades.

Since the collection is very complex,
one is naturally also interested in 
being able to use the data as long as
possible. In order to guarantee this,
regular updating is just as important
as good and clean data collection. The
principle "as accurate as possible" 
does not apply to the collection of 
data, but "as accurate as necessary".

== QGIS Exercise

In the theory part you learned how
to get the geodata you need for your
GIS. In this exercise, you will 
integrate data from a text file into
your GIS so that it can be spatially 
referenced and geographically 
represented. You will also update data
in an existing dataset.

=== Learning objectives

When you've solved the exercise,
you've learned the following:

* spatially visualize a text
file with coordinates in a GIS
* label a layer with an
attribute value
* create new objects 
(geometry and attributes)
* change the display of the data
via the layer properties

=== Object from text file

The location of the cantonal capitals
is stored in the text file Hauptorte.txt.
Open this file in a text editor and 
take a closer look at the content.

image:einfuehrung_in_qgis/ausrufezeichen.png[exclamation mark, 15, 15]
_Task 2_ +
_In what form is the location of
themain locations stored and how
is the information separated 
from each other? Write your 
findings on your worksheet._

ifdef::show_solutions[]
====
_Solution_

.Attributes of the cantons in text form
image::einfuehrung_in_qgis/abspeichern.png["Abspeichern", 502, 192]

The position of the main locations is 
indicated by the X-coordinate (X-coordinate)
and the Y-coordinate (Y-coordinate). +

The attribute names are stored in the first
line of the text file. In our case, these
values are separated by commas. +

From the 2nd line onwards, the captured
objects follow. The attributes of the
individual objects are also separated by
commas. A new object always starts on a 
new line. For text values, quotation marks
must appear at the beginning and 
end of the value. +

The first line defines which separators are
used in the document. The characters 
selected there must also be used as 
separators in the rest of the document.
====
endif::show_solutions[]

Das Werkzeug _Add Delimited Text Layer_
um Koordinatenwerte
aus einem Textfile zu lesen,
kann in der Werkzeugleiste _Manage Layers Toolbar_
gefunden werden.
Wenn du nicht mehr weisst,
wie man Werkzeuleisten einblendet,
schaue dir nochmals Kapitel 1 an.

Öffne das neue Werkzeug
und gib zuerst die Art
des Trennzeichens ein,
welches die Informationen
im Textfile voneinander trennt
(siehe Resultat der letzten Aufgabe).

Klicke dann auf den … -Button
und wähle die Textdatei _Hautporte.txt_ aus.
Das Werkzeug trennt das Textfile
nun automatisch in verschiedene Felder auf,
wobei das gewählte Trennzeichen
den Ausschlag gibt,
wo das neue Feld beginnt.

Unter der Geometrie erscheint nun
automatisch ein Vorschlag,
welches Feld als X-Feld
und welches als Y-Feld
benutzt werden soll.
Vergleiche den Vorschlag
mit deinen Überlegungen.
Falls du nicht einverstanden bist,
ändere den Eintrag.
Klicke anschliessend auf den OK-Button
um die Hauptorte im Projekt anzuzeigen.

Um später auch räumliche Analysen
mit dem neuen Layer Hauptorte
durchführen zu können,
muss dem Layer noch das gleiche Koordinatenbezugssystem
wie den restlichen Layern
zugeordnet werden.
Öffne die _Layer Properties_ der Hauptorte
und suche unter _Source_:
das richtige _CRS_/_KBS_.
Wähle das Koordinatensystem
CH1903 /LV03 mit der EPSG-Nr. 21781.

Wenn du nun die Attributstabelle öffnest,
siehst du die Informationen des Textfiles
in einer Tabelle dargestellt.
Zusätzlich wurde aus den ausgewählten Zahlen
für die X- und Y-Koordinaten
eine Position in der Karte berechnet
und dort ein Punkt abgesetzt.

=== Beschriftung eines Layers

Nun sollen die Hauptorte
noch beschriftet werden.
Öffne dazu das _Layer Properties_-Fenster
und wähle die Option _Labels_.
Wähle bei _Beschriftungen anzeigen_
das Feld _Single Labels_ und wähle als _Beschreibungsfeld_
das Feld mit dem Namen _Hauptort_.
Passe anschliessend die Schriftgrösse,
die Platzierung,
das Freistellen etc. an,
bis die Beschriftung "ins Bild" passt.
Wähle ausserdem zusätzlich
geeignetere Punktsymbole für die Hauptorte.

==== Darstellungsfarben ändern

Wie bist du denn mit den Darstellungsfarben
der Seen und der Kantone zufrieden?
Bist du nicht auch der Meinung,
dass die Farbe hellgelb für die Einfärbung der Kantone
und die Farbe blau für die Seen
besser geeignet wäre?
Um die Darstellungsfarbe zu ändern,
musst du durch Rechtsmausklick
auf den Layer -> _Properties..._
oder durch Doppelklick auf den Layer
das Fenster mit dem Namen _Layer Properties_ öffnen.

Zuerst soll die Darstellung
der Kantone geändert werden.
Öffne deshalb das _Layer Properties_-Fenster
für die Kantonsgrenzen.

.Darstellungsoptionen des Layers Kantonsgrenzen
image::einfuehrung_in_qgis/qgis_layer_properties_kantonsgrenzen.PNG["Layer-Eigenschaften Kantonsgrenzen", 537, 359]

Überprüfe,
ob im Auswahlfenster auf der linken Seite
die Option Darstellung ausgewählt ist.
So gelangst du zu einer Maske,
in welcher du mit wenigen Schritten
die Füllfarbe und –art
und die Umrandungsoptionen ändern kannst.
Probiere diese Optionen aus
und wähle für die Kantonsflächen eine hellgelbe Füllfarbe
und eine orangefarbene Umrandung.
Durch Klicken auf den _Apply_-Button
kannst du deine Einstellungen
schon mal im Kartenfenster betrachten.
Wenn du zufrieden bist,
kannst du das Fenster durch Klicken
auf den OK-Button schliessen.

Die Seen sollen eine zweifarbige Füllung erhalten.
Öffne dazu das Fenster
mit dem Namen _Layer Properties_
für den Layer Seen.

.Darstellungsoptionen des Layers Seen
image::einfuehrung_in_qgis/qgis_layer_properties_seen.PNG["Layer-Eigenschaften Seen", 537, 359]

Erstelle dazu
durch Klicken auf den + -Button
einen zweiten Symbollayer.
Wähle für den unteren Layer
die Füllfarbe hellblau
und den Füllstil _Solid_
und für den oberen Layer
als Füllfarbe ein dunkleres Blau
als für den ersten Layer
und als Füllstil die Option _Dense 4_.
Die Randfarbe soll die gleiche sein
wie die Füllfarbe
und die Randbreite soll _0.4_ betragen.
Wenn du zufrieden bist mit der Füllung,
schliesse die beiden Fenster
durch klicken auf OK.
Bist du nicht auch der Meinung,
dass die Darstellung im Kartenfenster
nun schon viel besser aussieht?

=== Locator Bar

Eine neues Werkzeug,
welches in QGIS 3 eingeführt wurde,
ist die _Locator Bar_.

In QGIS kann die _Locator Bar_ mit dem Tastaturkürzel
*Strg + K*
geöffnet werden.

Mit der _Locator Bar_ können Aktionen,
"Rechner" (Rechen-Operationen),
Verarbeitungsalgorithmen
und vieles mehr von QGIS gesucht werden.

Probiere das Werkzeug selber aus,
indem du den Layer Seen selektierst
und in der _Locator Bar_ nach einem See suchst.
Verwende für die Suche den Präfix `f`.

Beispiel: `f Greifensee`

NOTE: Die Präfixe findest du,
indem du mit *Strg + K* den Locator öffnest,
oder unter _Settings_ ->
_Options..._ ->
_Locator_

=== Objekte erfassen

Es sollen nun zusätzlich
zu den bestehenden Seen
zwei weitere Seen erfasst werden:
der _Lungernsee_ und der _Wägitalersee_.

Um den Lungernsee zu erfassen,
zoome in die Nähe von _Sarnen_.
Der See zwischen _Giswil_,
_Brienz_ und _Meiringen_ ist der _Lungernsee_.
Um überhaupt Daten erfassen zu können,
muss der Layer mit den Seen markiert werden
und aus dem Werkzeugkasten _Digitizing Toolbar_
der Button _Toggle Editing_
ausgewählt werden.
Das Gleiche geschieht mit Rechtsmausklick
auf den Layer und dann
die Option _Toggle Editing_ wählen.
Probiere beide Methoden mal aus
und entscheide dich für eine,
welche du in Zukunft verwenden möchtest.

Die Buttons,
welche für die Digitalisierung
gebraucht werden können,
werden nun aktiviert.
Wähle den Button _Add Polygon Feature_
und setze Punkte entlang der hellblauen Linie
des Uferbereiches auf der Karte ab.
Um die Fläche zu schliessen,
drücke die rechte Maustaste.
Es erscheint automatisch ein Fenster,
in welchem die Attribute
eingegeben werden können.
Gib folgende Werte ein:

*Name:* Lungernsee;
*Type:* Speichersee;

*Fläche:* 2.01 km^2^;
*Höhe:* 688.0 m.ü.M;
*Tiefe:* 68 m;
*Volumen:* 0.065 km^3^

Der zweite zu erfassende See
hat wie bereits erwähnt
den Namen _Wägitalersee_
und liegt zwischen dem _Sihlsee_,
dem _Zürichsee_
und der Ortschaft _Glarus_.
Erfasse auch die Geometrie
und die Attribute dieses Sees.
Hier noch einige Infos:

*Name:* Wägitalersee;
*Type:* Speichersee;

*Fläche:* 4.18 km^2^;
*Höhe:* 900.0 m.ü.M;
*Tiefe:* 65 m;
*Volumen:* 0.150 km^3^

Um die Änderungen zu speichern,
muss der Bearbeitungsstatus
wieder umgestellt werden.
Solange du dies nicht tust,
sind die Daten,
die du erfasst hast,
nicht abgespeichert.

Herzliche Gratulation,
du hast deine ersten Objekte
mit QGIS selber erfasst!

== Kapiteltest 3

Willkommen beim Kapiteltest 3.
Inzwischen bist du ja schon
ein alter Kapiteltest-Hase
und weisst genau,
was zu erledigen ist.
Deshalb hier
ohne grosse Worte
die Fragen:

=== Frage 1

Vektordaten können in
unterschiedlicher Form
abgespeichert werden.

_Welche zwei Arten
kennst du?_

Schreibe bei jeder Form
noch einen zusätzlichen Satz,
in welchem du je
eine Besonderheit nennst.

ifdef::show_solutions[]
====
.Lösung
. Shapefile +
Die einfachste und schnellste
Form der Speicherung von
Vektordaten sind Shapefiles,
welche ihre Daten auf verschiedene
Dateien verteilen.
. Geodatenbanken +
Eine weitere Form der
Speicherung von Vektordaten
sind spezielle Datenbanken,
sogenannte Geodatenbanken.
Sie unterscheiden sich von
normalen Datenbanken dadurch,
dass sich mit ihnen zusätzlich
noch die Geometrie verwalten
lässt und nicht nur die Daten.
====
endif::show_solutions[]


=== Frage 2

Nicht nur in einem GIS
werden Informationen oft
in Form einer Tabelle
abgespeichert.

_Wie würdest du jemandem,
der noch nie
eine Tabelle gesehen hat,
den Aufbau
einer solchen beschreiben?_

Zur Beantwortung dieser Frage
darfst du auch eine Skizze
zu Hilfe nehmen.
Die wichtigen Begriffe
müssen jedoch in deiner Antwort
schriftlich stehen.

ifdef::show_solutions[]
====
_Lösung_

|===
|ID	|Vorname|Nachname|	Email
|1|Elena|Meller|Elena.me@gmail
|2|Nina|Schurter|Nina.Schur@gmx
|3|Ben|Schulte|Ben.Schul@gmx
|4|Miriam|Orler|Miriam.orl@hotmail
|5|Lukas|Gerber	|Lukas.gerb@gmail
|===

Die oben abgebildeten Daten haben die
Form einer Tabelle und sie sollen hierbei
als Beispiel dienen, um eine Tabelle
zu veranschaulichen. +

Tabellen dienen dazu, Informationen
geordnet abzulegen. Dabei bestehen
sie aus Zeilen (horizontal) und
Spalten (vertikal). Eine Zeile
beinhaltet einen sogenannten
Datensatz, auch Tupel genannt.
Ein Datensatz beinhaltet
verschiedene Daten, welche
zusammengehören und erst zusammen
aussagekräftig sind. Oben im Beispiel
wäre Elena Meller mit der Email
Elena.me@gmail und der ID 1 eine
Datensatz. Daneben gibt es noch
Spalten, welche Attribute enthalten,
welche wiederum eine Teilmenge eines
Datensatzes darstellen.
====
endif::show_solutions[]

=== Frage 3

Eine Art,
um Informationen zu Objekten
abzuspeichern ist,
diese in ein Textfile
zu schreiben.

. Was muss in einem Textfile
minimal gespeichert werden,
damit die Information
aus dem File im Kartenfenster
angezeigt werden kann
. Was muss beim Erfassen der Werte
im Textfile beachtet werden.
Wieso muss dies beachtet werden?

Beantworte die Fragen
in eigenen Worten
und begründe deine Antworten.
Denke bei der Beantwortung
der Fragen auch
an die Übung zurück.

ifdef::show_solutions[]
====
.Lösung
. Es müssen Koordinaten- und
Attributwerte vorhanden sein +
. Es muss darauf geachtet
werden, dass die erste Zeile
des Textfiles die Attributnamen
getrennt durch ein Komma enthält.
Danach, in den darauffolgenden
Zeilen, folgen die Objekte,
bei welchen die Attribute auch
durch Kommas getrennt werden. +
====
endif::show_solutions[]

=== Frage 4

Du erhältst von deinem Klassenlehrer
den Auftrag,
für die nächste Schulreise
ein GIS zu erstellen,
in welchem die
verschiedenen Zwischenstationen
des Ausfluges
und die Wanderroute
räumlich dargestellt sind.

_Welche Möglichkeiten hast du,
um an die verschiedenen Daten zu kommen?_

Wähle zwei Themen aus,
die du im Schulreise-GIS
darstellen möchtest.
Beantworte die Frage
für beide Themen.
Es müssen jedoch
zwei unterschiedliche Erfassungsarten
beschrieben werden.
Es gibt mehrere
richtige Möglichkeiten.

ifdef::show_solutions[]
====
.Lösung
. Haltestellen der ÖV-Verbindungen +
Zeitplan und Ort der Haltestellen
auf Homepage der ÖV-Anbieter
nachschauen und im GIS
implementieren. +
. Ungefährliche Wanderwege
durch Naturlandschaft +
Frei zugängliche Luftaufnahmen
(Bsp. Bing Maps) analysieren
und bestmögliche Route bestimmen
und einzeichnen.

====
endif::show_solutions[]
