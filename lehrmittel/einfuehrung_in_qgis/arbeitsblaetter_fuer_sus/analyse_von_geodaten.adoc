= Einführung in QGIS 3: Datenanalyse (Kapitel 4)
OpenSchoolMaps.ch -- Freie Lernmaterialien zu freien Geodaten und Karten
:xrefstyle: short
:imagesdir: ../../../bilder/
include::../../../snippets/lang/de.adoc[]
include::../../../snippets/suppress_title_page.adoc[]

*Ein Arbeitsblatt für Schülerinnen und Schüler*

In den letzten Kapiteln
hast du erfahren,
wie Geodaten erfasst
und in einem GIS dargestellt werden.
Somit ist alles vorbereitet
für die „Spezialität“ des GIS,
nämlich das Ableiten
von neuen Informationen
aus bestehenden raumbezogenen Daten.
Dieses Ableiten
von neuen Informationen
nennt man Analyse.

== Lernziele

Dieses Kapitel beinhaltet
folgende Lernziele:

* den Unterschied zwischen
Abfragen und Manipulationen
in eigenen Worten erklären
* aufzählen,
welche Abfragearten es gibt
und diese mit Hilfe
je eines Beispiels erklären
* für eine thematische Abfrage
eine korrekte SQL-Abfrage formulieren

== Theorie

image:einfuehrung_in_qgis/ausrufezeichen.png["Ausrufe Zeichen", 15, 15]
_Löse als Einstieg
in das Kapitel Datenanalyse
folgende Aufgaben:_

. _Suche 1:
Rufe die Homepage http://tel.local.ch/de/ auf
und gib den Namen
und falls bekannt
auch den Wohnort einer Person ein,
die du kennst
und die einen Eintrag
im Telefonbuch haben könnte
(z.B. deine Eltern oder deine Grosseltern).
Klicke anschliessend
auf den Suchen - Button.
Was ist das Resultat
deiner Suche?
In welcher Form
sind die Eingabe
und die Ausgabe der Suche,
wenn du die Suche
auf der Seite tel.local.ch
allgemein betrachtest?_
. _Suche 2:
Rufe als nächstes
die Homepage http://www.sbb.ch/ auf
und suche nach der nächsten Verbindung
vom Bahnhof der am nächsten
bei deinem Wohnort liegt nach Chur.
Betrachte wieder die Eingabe-
und Ausgabewerte.
Dabei sind nicht so sehr
die Resultate selber wichtig
sondern die Form,
in welcher die Resultate
ausgegeben werden.
Mache dir dazu
wieder einige Notizen._
. _Vergleich:
Was fällt dir auf,
wenn du nun die Art
der Resultate der Suche 1
und der Suche 2 vergleichst?
Schreibe deine Feststellungen auf._

Behalte deine Lösungen
im Hinterkopf.
Wir werden später
in diesem Kapitel
nochmals auf diese Aufgabe
zurückkommen.

Wie bereits
in der Einleitung angedeutet,
ist das Ableiten von neuen Informationen
aus bestehenden raumbezogenen Daten
eine der wertvollsten
und wichtigsten Funktionen
eines GIS.

Allgemein werden
zwei Arten von Analysen
unterschieden:
Abfragen und Manipulationen.
Bei den Abfragen
werden die Daten
nicht verändert,
bei den Manipulationen
werden entweder
die Daten verändert
oder es werden
neue Daten erzeugt.

=== Abfragen

Es gibt drei Möglichkeiten,
nach welchen Gesichtspunkten
eine Abfrage durchgeführt
werden kann.

. Abfragen anhand von Sachdaten.
Beispiel: Selektiere alle Seen,
die eine Wassertiefe haben,
die grösser als 100 m ist.
Diese Abfragen werden
*thematische Abfragen
oder Selektionen* genannt.
. Abfragen anhand von Beziehungen
zwischen verschiedenen
geometrischen Objekten.
Beispiel: Selektiere alle Seen,
die vollständig innerhalb
eines Kantons liegen.
Diese Abfragen werden
*topologische Abfragen
oder Selektionen* genannt.
. Abfragen über
die Geometrie der Objekte.
Beispiel: Welche Hauptorte
liegen in einem Abstand
von weniger als 20 km
um den Vierwaldstättersee.
Diese Abfragen werden
*geometrische Abfragen
oder Selektionen* genannt.

image:einfuehrung_in_qgis/ausrufezeichen.png["Ausrufe Zeichen", 15, 15]
_Überlege dir,
um welche Arten
von Abfragen es sich
bei der Einstiegsübung
handelte?_

=== Datenbanksprache SQL

Um thematische
Abfragen durchzuführen,
wird die Datenbanksprache
*SQL (Structured Query Language)*
verwendet.
Falls du bereits
mit Datenbanken gearbeitet hast,
wirst du die Sprache bestimmt
bereits kennen.
Dann ist für dich
der nächste Abschnitt Repetition.
Für alle anderen
ist es eine kurze Einführung
über die wichtigsten Strukturen
und Ausdrücke
einer Abfrage mit SQL.

Eine _SQL-Abfrage_
ist vereinfacht dargestellt
wie folgt aufgebaut:

*SELECT AUSWAHLLISTE* +
*FROM QUELLE* +
*WHERE WHERE-KLAUSEL*

Überblick über die Variablen
die du für einfache Abfragen
kennen solltest:

*AUSWAHLLISTE:*
Namen aller Attribute,
die als Resultat
angezeigt werden sollen.
* bedeutet,
es werden alle
Attribute angezeigt.
Bei thematischen Abfragen
in einem GIS
ist nur die Abfrage
nach allen Attributen möglich.
Deshalb muss diese Variable
im GIS nicht eingestellt werden.

*QUELLE:*
Namen der Tabellen,
die Attribute enthalten,
welche bei der Abfrage
eine Rolle spielen

*WHERE-KLAUSEL:*
Bedingungen,
die erfüllt werden müssen

Überblick über
die SQL-Ausdrücke,
welche in einer Where-Klausel
verwendet werden können,
und ihre Bedeutung:

[%header,cols=2*]
|===
|SQL Ausdruck
|Bedeutung

|=
|gleich

|<
|kleiner

|$$<=$$
|kleiner oder gleich

|>
|grösser

|>=
|grösser oder gleich

|<>
|nicht gleich, verschieden

|LIKE
|Vergleich von Zeichenfolgen.
Dabei können folgende Zeichen
als Platzhalter eingesetzt werden:
%: Platzhalter für
beliebig viele Zeichen.
Z.B. LIKE
‚F%’ für alle Einträge,
die mit dem Buchstaben F beginnen
_ : Platzhalter für
genau ein Zeichen.
Z.B. LIKE ‚Me_er’,
wenn man nach einer Person
sucht und nicht weiss,
ob ihr Nachname Meier
oder Meyer ist.
Bei LIKE ‚M__er’
könnte er zusätzlich
auch Mayer lauten.

|IS NULL
|Zelle enthält keinen Wert

|IS NOT NULL
|Zelle enthält einen Wert

|BETWEEN
|zwischen zwei Werten
|===

Es können auch
mehrere Bedingungen
hintereinander gesetzt werden.
Durch logische Operatoren
kann definiert werden,
ob die _Bedingung 1_
*und* (*AND*) _Bedingung 2_
*oder* _Bedingung 1_
oder (*OR*) _Bedingung 2_
oder _Bedingung 1_
*und nicht* (*NOT*) _Bedingung 2_
gelten sollen.

Hier zur Veranschaulichung
das Ganze nochmals
mit Hilfe von Venn-Diagrammen
dargestellt:

[cols="1,1a"]
|===

|*AND*-Operator:
Welches Element
gehört zur Menge A
und zur Menge B?
|image::einfuehrung_in_qgis/and_operator.jpg["AND Operator", 113, 69]

|*OR*-Operator:
Welches Element
gehört zur Menge A
oder zur Menge B?
|image::einfuehrung_in_qgis/or_operator.jpg["OR Operator", 113, 69]

|*NOT*-Operator:
Welches Element
gehört zur Menge A
aber nicht zur Menge B?
|image::einfuehrung_in_qgis/not_operator.jpg["NOT Operator", 113, 69]
|===

image:einfuehrung_in_qgis/ausrufezeichen.png["Ausrufe Zeichen", 15, 15]
_Probiere nun
selber mal aus,
folgende einfache Abfrage
in SQL zu formulieren:_

. _Es sollen alle Seen
selektiert werden,
deren Fläche grösser
als 20 km2 sind
und die tiefer
als 400 m.ü.M. liegen._
. _Die Suche die du
als Einstieg
in die Theorie
als Suche 1
auf der Homepage
http://tel.local.ch/de/
durchgeführt hast._

== Übung 4

Die "Spezialität" eines GIS
soll natürlich auch nicht nur
in der Theorie vermittelt werden.
In diesem Kapitel wirst du
selber einige thematische
und räumliche Abfragen durchführen.
